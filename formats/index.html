<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>OCR Formats - Solr OCR Highlighting Plugin</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "OCR Formats";
    var mkdocs_page_input_path = "formats.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Solr OCR Highlighting Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../getting_started/">Getting Started</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">OCR Formats</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#hocr">hOCR</a></li>
    

    <li class="toctree-l2"><a href="#alto">ALTO</a></li>
    

    <li class="toctree-l2"><a href="#miniocr">MiniOCR</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../external_storage/">External Storage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../example/">Example Setup</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../queryparams/">Query Parameters</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faq/">Frequently Asked Questions</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Solr OCR Highlighting Plugin</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>OCR Formats</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/dbmdz/solr-ocrhighlighting/edit/master/docs/formats.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>In general the plugin assumes that all OCR formats encode their documents
in a hierarchy of <strong>blocks</strong>. For all supported formats, we map their
block types to these general types:</p>
<ul>
<li><strong>Page</strong>: optional if there is only a single page in a document</li>
<li><strong>Block</strong>: optional if <a href="../queryparams/"><code>hl.ocr.limitBlock</code></a> is set to a different value at
  query time</li>
<li><strong>Section</strong>: optional</li>
<li><strong>Paragraph</strong>: optional</li>
<li><strong>Line</strong>: (optional if <a href="../queryparams/"><code>hl.ocr.contextBlock</code></a> is set to a different value
  at query time)</li>
<li><strong>Word</strong>: <em>required</em></li>
</ul>
<p>These block types can be used in the <a href="../queryparams/"><code>hl.ocr.limitBlock</code> and <code>hl.ocr.contextBlock</code>
query parameters</a> to control how snippets are generated.</p>
<h2 id="hocr">hOCR</h2>
<p>In the <strong>Solr configuration</strong>, set the <code>ocrFormat</code> attribute on the <code>&lt;searchComponent /&gt;</code> to
<code>org.mdz.search.solrocr.formats.hocr.HocrFormat</code>.</p>
<p>In the <strong>Schema</strong>, make sure that <code>solr.HTMLStripCharFilterFactory</code> is the first filter
in your indexing analyzer chain for OCR fields.</p>
<p><strong>Block type mapping:</strong></p>
<table>
<thead>
<tr>
<th>Block</th>
<th>hOCR class</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Word</td>
<td><code>ocrx_word</code></td>
<td>needs to have a <code>bbox</code> attribute with the coordinates on the page</td>
</tr>
<tr>
<td>Page</td>
<td><code>ocr_page</code></td>
<td>needs to have a <code>ppageno</code> attribute with a page identifier</td>
</tr>
<tr>
<td>Block</td>
<td><code>ocr_carea</code>/<code>ocrx_block</code></td>
<td></td>
</tr>
<tr>
<td>Section</td>
<td><code>ocr_chapter</code>/<code>ocr_section</code>/<br><code>ocr_subsection</code>/<code>ocr_subsubsection</code></td>
<td></td>
</tr>
<tr>
<td>Paragraph</td>
<td><code>ocr_par</code></td>
<td></td>
</tr>
<tr>
<td>Line</td>
<td><code>ocr_line</code> or <code>ocrx_line</code></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="alto">ALTO</h2>
<p>In the <strong>Solr configuration</strong>, set the <code>ocrFormat</code> attribute on the <code>&lt;searchComponent /&gt;</code> to
<code>org.mdz.search.solrocr.formats.alto.AltoFormat</code>.</p>
<p>In the <strong>Schema</strong>, make sure that <code>org.mdz.search.solrocr.formats.alto.AltoCharFilterFactory</code>
is the first filter in your indexing analyzer chain for OCR fields.</p>
<p><strong>Block type mapping:</strong></p>
<table>
<thead>
<tr>
<th>Block</th>
<th>ALTO tag</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Word</td>
<td><code>&lt;String /&gt;</code></td>
<td>needs to have <code>CONTENT</code>, <code>HPOS</code>, <code>VPOS</code>, <code>WIDTH</code> and <code>HEIGHT</code> attributes</td>
</tr>
<tr>
<td>Line</td>
<td><code>&lt;TextLine /&gt;</code></td>
<td></td>
</tr>
<tr>
<td>Block</td>
<td><code>&lt;TextBlock /&gt;</code></td>
<td></td>
</tr>
<tr>
<td>Page</td>
<td><code>&lt;Page /&gt;</code></td>
<td>needs to have an <code>ID</code> attribute with a page identifier</td>
</tr>
<tr>
<td>Section</td>
<td><em>not mapped</em></td>
<td></td>
</tr>
<tr>
<td>Paragraph</td>
<td><em>not mapped</em></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="miniocr">MiniOCR</h2>
<p>This plugin also includes support for a custom non-standard OCR format that
we dubbed <em>MiniOCR</em>. This format is intended for use cases where reusing the
existing OCR files is not possible (e.g. because they&rsquo;re in an unsupported
format or because you don&rsquo;t want to ASCII-encode them and still use the
modern highlighting approach). In these cases, minimizing the storage
requirements for the derived OCR files is important, which is why we defined
this minimalistic format.</p>
<p>A basic example looks like this:</p>
<pre><code class="xml">&lt;p id=&quot;page_identifier&quot;&gt;
  &lt;b&gt;
    &lt;l&gt;&lt;w x=&quot;50 50 100 100&quot;&gt;A&lt;/w&gt; &lt;w x=&quot;150 50 100 100&quot;&gt;Line&lt;/w&gt;&lt;/l&gt;
  &lt;/b&gt;
&lt;/p&gt;
</code></pre>

<p>In the <strong>Solr configuration</strong>, set the <code>ocrFormat</code> attribute on the <code>&lt;searchComponent /&gt;</code> to
<code>org.mdz.search.solrocr.formats.mini.MiniOcrFormat</code>.</p>
<p>In the <strong>Schema</strong>, make sure that <code>solr.HTMLStripCharFilterFactory</code> is the first filter
in your indexing analyzer chain for OCR fields.</p>
<p><strong>Block type mapping:</strong></p>
<table>
<thead>
<tr>
<th>Block</th>
<th>MiniOCR tag</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Word</td>
<td><code>&lt;w/&gt;</code></td>
<td>needs to have <code>box</code> attribute with <code>{x} {y} {width} {height}</code>. <br>Values can be integers or floats between 0 and 1</td>
</tr>
<tr>
<td>Line</td>
<td><code>&lt;l/&gt;</code></td>
<td></td>
</tr>
<tr>
<td>Block</td>
<td><code>&lt;b/&gt;</code></td>
<td></td>
</tr>
<tr>
<td>Page</td>
<td><code>&lt;p/&gt;</code></td>
<td>needs to have an <code>id</code> attribute with a page identifier</td>
</tr>
<tr>
<td>Section</td>
<td><em>not mapped</em></td>
<td></td>
</tr>
<tr>
<td>Paragraph</td>
<td><em>not mapped</em></td>
<td></td>
</tr>
</tbody>
</table>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../external_storage/" class="btn btn-neutral float-right" title="External Storage">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting_started/" class="btn btn-neutral" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/dbmdz/solr-ocrhighlighting/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../getting_started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../external_storage/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
